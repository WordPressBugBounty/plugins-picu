(()=>{"use strict";var e,l={247(e,l,t){const i=window.wp.blocks,s=window.wp.i18n,n=window.wp.blockEditor,o=window.wp.components,r=window.wp.apiFetch;var c=t.n(r);const a=window.wp.element,u=window.wp.htmlEntities,d=window.ReactJSXRuntime,p=JSON.parse('{"UU":"picu/collections-list"}');(0,i.registerBlockType)(p.UU,{edit:function({attributes:e,setAttributes:l}){const t=(0,n.useBlockProps)(),{postStatus:i="any",email:r,currentUser:p,ids:h,order:_="date_desc"}=e,[v,b]=(0,a.useState)([]),[w,f]=(0,a.useState)([]),[m,x]=(0,a.useState)(!0),j=window.picuBlocksData?.canManagePicu||!1,g=window.picuBlocksData?.isProActive||!1;(0,a.useEffect)(()=>{c()({path:"/picu/v1/emails"}).then(e=>{f(e)}).catch(e=>{console.error("Error fetching emails:",e)})},[]),(0,a.useEffect)(()=>{x(!0);const e=new URLSearchParams;i&&e.append("post_status",i),r&&!p&&e.append("email",r),p&&e.append("current_user",p),h&&h.length>0&&e.append("ids",h),_&&e.append("order",_),c()({path:`/picu/v1/collections?${e.toString()}`}).then(e=>{b(e.collections),x(!1)}).catch(e=>{console.error("Error fetching collections: ",e),x(!1)})},[i,r,p,h,_]);const C=(0,d.jsx)(n.InspectorControls,{children:j?(0,d.jsx)(o.PanelBody,{title:(0,s.__)("Settings","picu"),children:(0,d.jsxs)("fieldset",{children:[(0,d.jsx)(o.TextControl,{label:(0,s.__)("Client Email","picu"),help:(0,s.__)("Choose from the list or enter manually","picu"),value:p?"":r,onChange:e=>{l({email:e})},list:"emailAddresses",autoComplete:"off",name:"notASearchField",disabled:p,className:"picu-client-email-input"}),(0,d.jsx)("datalist",{id:"emailAddresses",children:Object.values(w).map((e,l)=>(0,d.jsx)("option",{value:e},l))}),(0,d.jsx)(o.ToggleControl,{label:(0,s.__)("Use current user address","picu"),checked:p,onChange:e=>{l({currentUser:e})}}),(0,d.jsx)(o.TextControl,{label:(0,s.__)("Collection ID","picu"),value:h,onChange:e=>{l({ids:e})}}),(0,d.jsx)(o.SelectControl,{label:(0,s.__)("Status","picu"),value:i,onChange:e=>{l({postStatus:e})},options:[{label:(0,s.__)("All","picu"),value:"any"},{label:(0,s.__)("Open","picu"),value:"open"},{label:(0,s.__)("Closed","picu"),value:"closed"},...g?[{label:(0,s.__)("Delivered","picu"),value:"delivered"}]:[]]}),(0,d.jsx)(o.SelectControl,{label:(0,s.__)("Sort by","picu"),value:_,onChange:e=>{l({order:e})},options:[{label:(0,s.__)("Date (newest first)","picu"),value:"date_desc"},{label:(0,s.__)("Date (oldest first)","picu"),value:"date_asc"},{label:(0,s.__)("Title (A-Z)","picu"),value:"title_asc"},{label:(0,s.__)("Title (Z-A)","picu"),value:"title_desc"}]})]})}):null},"setting");return m?(0,d.jsxs)("div",{...t,children:[(0,d.jsx)(o.Placeholder,{label:(0,s.__)("Loading Collections","picu"),children:(0,d.jsx)(o.Spinner,{})}),C]}):0===v.length?(0,d.jsxs)("div",{...t,children:[(0,d.jsx)("p",{children:(0,s.__)("No collections found.","picu")}),C]}):!0===p?(0,d.jsxs)("div",{...t,children:[(0,d.jsx)("div",{className:"picu-collections-list-current-user-wrap",children:(0,d.jsx)("div",{className:"picu-collections-list-current-user-info",children:(0,d.jsx)("p",{children:(0,s.__)("Displays collections sent to the currently logged in user.","picu")})})}),C]}):(0,d.jsxs)("div",{...t,children:[(0,d.jsx)("ul",{className:"picu-collections-list",children:v.map(e=>(0,d.jsx)("li",{children:(0,u.decodeEntities)(e.title)},e.id))}),C]})},save:function(){return null}})}},t={};function i(e){var s=t[e];if(void 0!==s)return s.exports;var n=t[e]={exports:{}};return l[e](n,n.exports,i),n.exports}i.m=l,e=[],i.O=(l,t,s,n)=>{if(!t){var o=1/0;for(u=0;u<e.length;u++){for(var[t,s,n]=e[u],r=!0,c=0;c<t.length;c++)(!1&n||o>=n)&&Object.keys(i.O).every(e=>i.O[e](t[c]))?t.splice(c--,1):(r=!1,n<o&&(o=n));if(r){e.splice(u--,1);var a=s();void 0!==a&&(l=a)}}return l}n=n||0;for(var u=e.length;u>0&&e[u-1][2]>n;u--)e[u]=e[u-1];e[u]=[t,s,n]},i.n=e=>{var l=e&&e.__esModule?()=>e.default:()=>e;return i.d(l,{a:l}),l},i.d=(e,l)=>{for(var t in l)i.o(l,t)&&!i.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:l[t]})},i.o=(e,l)=>Object.prototype.hasOwnProperty.call(e,l),(()=>{var e={406:0,522:0};i.O.j=l=>0===e[l];var l=(l,t)=>{var s,n,[o,r,c]=t,a=0;if(o.some(l=>0!==e[l])){for(s in r)i.o(r,s)&&(i.m[s]=r[s]);if(c)var u=c(i)}for(l&&l(t);a<o.length;a++)n=o[a],i.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return i.O(u)},t=globalThis.webpackChunkpicu_blocks=globalThis.webpackChunkpicu_blocks||[];t.forEach(l.bind(null,0)),t.push=l.bind(null,t.push.bind(t))})();var s=i.O(void 0,[522],()=>i(247));s=i.O(s)})();